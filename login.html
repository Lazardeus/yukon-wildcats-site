<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Yukon Wildcats Contracting</title>
  <link rel="stylesheet" href="css/style.css?v=20251110b">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
  <script defer src="js/particles-config.js?v=20251110b"></script>
  <script defer src="js/script.js?v=20251110b"></script>
</head>

<body>
    <!-- Particles Background -->
    <div id="particles-js"></div>
    
    <!-- Back Navigation -->
    <a href="index.html" class="back-link">
        <i class="fas fa-arrow-left"></i>
        Back to Home
    </a>

    <main class="auth-wrapper" id="login-page" style="max-width:420px;margin:3rem auto;padding:2rem;background:rgba(0,0,0,0.7);border:1px solid rgba(255,215,0,0.3);border-radius:16px;backdrop-filter:blur(6px);">
        <div class="logo" style="width:70px;height:70px;background:#111;border:2px solid #ffd700;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 1.2rem;box-shadow:0 0 12px rgba(255,215,0,0.4)">
            <img src="assets/logo.png" alt="Logo" style="width:60px;height:60px;border-radius:50%" />
        </div>
        <h1 class="login-title" style="text-align:center;color:#ffd700;font-size:1.8rem;margin-bottom:.4rem;">Account Access</h1>
        <p class="login-subtitle" style="text-align:center;color:#ccc;font-size:.9rem;margin-bottom:1.5rem;">Admin / Owner secure login</p>

        <div id="login-alert" aria-live="polite" style="display:none;margin-bottom:1rem;padding:.8rem 1rem;border-radius:8px;font-size:.85rem;font-weight:600"></div>

        <form id="loginForm" novalidate>
            <div class="form-group" style="margin-bottom:1rem;">
                <label for="username" class="form-label" style="display:block;color:#ffd700;font-size:.85rem;margin-bottom:.4rem;">Username</label>
                <input id="username" name="username" type="text" autocomplete="username" class="form-input" required placeholder="admin or manager" style="width:100%;padding:.9rem;background:rgba(255,255,255,0.08);border:1px solid rgba(255,215,0,0.3);border-radius:8px;color:#fff;" />
            </div>
            <div class="form-group" style="margin-bottom:1rem;">
                <label for="password" class="form-label" style="display:block;color:#ffd700;font-size:.85rem;margin-bottom:.4rem;">Password</label>
                <input id="password" name="password" type="password" autocomplete="current-password" class="form-input" required placeholder="Enter password" style="width:100%;padding:.9rem;background:rgba(255,255,255,0.08);border:1px solid rgba(255,215,0,0.3);border-radius:8px;color:#fff;" />
            </div>
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.2rem;">
                <label style="display:flex;align-items:center;gap:.4rem;color:#ccc;font-size:.75rem;">
                    <input type="checkbox" id="rememberUser" style="accent-color:#ffd700;"> Remember me
                </label>
                <button type="button" id="forgotBtn" style="background:none;border:none;color:#ffd700;font-size:.75rem;cursor:pointer;">Forgot?</button>
            </div>
            <button type="submit" class="submit-btn" style="background:#ffd700;color:#111;font-weight:700;width:100%;padding:1rem;border:none;border-radius:10px;cursor:pointer;box-shadow:0 4px 15px rgba(255,215,0,0.4);transition:.3s;">Login</button>
        </form>
        <div style="text-align:center;margin-top:1.5rem;font-size:.7rem;color:#666;">Unauthorized access is prohibited. Activity may be monitored.</div>
    </main>

    <script>
    (function(){
      const form = document.getElementById('loginForm');
      const alertBox = document.getElementById('login-alert');
      const remember = document.getElementById('rememberUser');
      const userInput = document.getElementById('username');
      const passInput = document.getElementById('password');
      const forgotBtn = document.getElementById('forgotBtn');

      function showAlert(msg,type){
        alertBox.textContent = msg;
        alertBox.style.display='block';
        alertBox.style.background = type==='success' ? 'rgba(40,167,69,0.15)' : 'rgba(220,53,69,0.15)';
        alertBox.style.border = '1px solid ' + (type==='success' ? '#28a745' : '#dc3545');
        alertBox.style.color = type==='success' ? '#28a745' : '#dc3545';
      }
      function clearAlert(){alertBox.style.display='none';alertBox.textContent='';}

      if (localStorage.getItem('yw_remember_user')) {
        userInput.value = localStorage.getItem('yw_remember_user');
        remember.checked = true;
      }

      forgotBtn.addEventListener('click',()=>{
        const email = prompt('Enter recovery email (not implemented)');
        if(email){showAlert('Recovery instructions (placeholder).','success');}
      });

      form.addEventListener('submit', async (e)=>{
        e.preventDefault();
        clearAlert();
        const username = userInput.value.trim();
        const password = passInput.value;
        if(!username || !password){showAlert('Username and password required.');return;}
        try{
          const res = await fetch('/api/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username,password})});
          if(!res.ok){
            const data = await res.json().catch(()=>({message:'Login failed'}));
            showAlert(data.message || 'Invalid credentials');
            return;
          }
          const data = await res.json();
          if(!data.token){showAlert('Token missing in response');return;}
          localStorage.setItem('yw_auth_token', data.token);
          localStorage.setItem('yw_auth_role', data.role || 'admin');
          if(remember.checked){localStorage.setItem('yw_remember_user', username);} else {localStorage.removeItem('yw_remember_user');}
          showAlert('Login successful. Redirecting...','success');
          setTimeout(()=>{window.location.href='admin.html';},800);
        }catch(err){
          console.error('Login error',err);
          showAlert('Network or server error.');
        }
      });
    })();
    </script>
</body>
</html>

